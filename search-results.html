<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Search Results - Room Finder</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">

<style>
  html, body { height: 100%; }
  body { display: flex; flex-direction: column; }
  main { flex: 1; }

  .page-content { padding-top: 90px; }

  /* FILTER BAR */
  .filter-bar {
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(20px);
    border-radius: 18px;
    padding: 20px;
    margin-bottom: 30px;
    box-shadow: 0 0 20px rgba(0,0,0,0.25);
  }

  .filter-bar input,
  .filter-bar select {
    background: rgba(255,255,255,0.4);
    border: none;
    padding: 10px;
    border-radius: 8px;
  }
</style>
</head>
<body>

<div id="navbar"></div>

<main>
<section class="container page-content">

  <h2 id="searchTitle" class="text-center fw-bold mb-1" data-aos="fade-up"></h2>
  <p id="resultCount" class="text-center text-muted mb-4"></p>

  <!-- HORIZONTAL FILTER BAR -->
  <div class="filter-bar" data-aos="fade-down">
    <div class="row g-3">
      
      <div class="col-md-4">
        <input type="text" id="filterLocation" class="form-control" placeholder="Filter by location...">
      </div>

      <div class="col-md-3">
        <input type="number" id="filterPrice" class="form-control" placeholder="Max Price e.g. 15000">
      </div>

      <div class="col-md-3">
        <select id="filterType" class="form-control">
          <option value="">Any Room Type</option>
          <option value="1 room">1 Room</option>
          <option value="2 room">2 Rooms</option>
          <option value="flat">Flat</option>
        </select>
      </div>

      <div class="col-md-2">
        <button class="btn btn-primary w-100" id="applyFilters">Filter</button>
      </div>

    </div>
  </div>

  <div id="resultsContainer" class="row g-4"></div>

</section>
</main>

<div id="footer"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>

<script>
AOS.init({ duration: 1000, once: true });

const params = new URLSearchParams(window.location.search);
const mainQuery = params.get('location')?.toLowerCase() || "";

document.getElementById("searchTitle").textContent = `Search results for "${mainQuery}"`;

let roomsData = [];

fetch("rooms.json")
  .then(res => res.json())
  .then(data => {
    roomsData = data;
    applyFilters(); 
  });

document.getElementById("applyFilters").addEventListener("click", applyFilters);

function applyFilters() {
  const filterLocation = document.getElementById("filterLocation").value.toLowerCase();
  const filterPrice = document.getElementById("filterPrice").value;
  const filterType = document.getElementById("filterType").value.toLowerCase();

  const filteredRooms = roomsData.filter(room => {
    const locationMatch =
      room.location.toLowerCase().includes(mainQuery) ||
      room.title.toLowerCase().includes(mainQuery) ||
      room.area.toLowerCase().includes(mainQuery);

    const applyLocation = filterLocation
      ? room.location.toLowerCase().includes(filterLocation)
      : true;

    const applyPrice = filterPrice
      ? Number(room.rent) <= Number(filterPrice)
      : true;

    const applyType = filterType
      ? room.area.toLowerCase().includes(filterType)
      : true;

    return locationMatch && applyLocation && applyPrice && applyType;
  });

  renderResults(filteredRooms);
}

function renderResults(list) {
  const container = document.getElementById("resultsContainer");
  container.innerHTML = "";

  document.getElementById("resultCount").textContent =
    `${list.length} result${list.length !== 1 ? "s" : ""} found`;

  list.forEach(room => {
    const card = document.createElement("div");
    card.className = "col-md-4";
    card.innerHTML = `
      <div class="card room-card shadow-lg border-0" data-aos="zoom-in">
        <img src="${room.image}" class="card-img-top" alt="${room.title}">
        <div class="card-body">
          <h5 class="card-title">${room.title}</h5>
          <p class="text-muted">üìç ${room.location}</p>
          <p><strong>Contact:</strong> ${room.contact}</p>
          <p>Area: ${room.area}</p>
          <p>Rent: NPR ${room.rent}</p>
          <a href="room-details.html?id=${room.id}" class="btn btn-outline-primary w-100 mt-2">
            View Details
          </a>
        </div>
      </div>`;
    container.appendChild(card);
  });
}
</script>

<script src="all_script.js"></script>
</body>
</html>
